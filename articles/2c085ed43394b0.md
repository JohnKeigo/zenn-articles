---
title: "stable-diffusion-webui-docker ã‚’ä½¿ã£ã¦Waifu Diffusionãƒ¢ãƒ‡ãƒ«ç­‰ã‚’ä½¿ã†"
emoji: "ğŸ˜€"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [stable diffusion,waifu diffusion,git,docker,gradio]
published: false
---

ã‚‚ã®ã™ã”ã„ã‚¹ãƒ”ãƒ¼ãƒ‰ã§Forkç‰ˆãŒé–‹ç™ºã•ã‚Œç¶šã‘ã‚‹Stable Diffusionã®web-uiã‚’Docker Containerä¸Šã§ä½¿ãˆã‚‹ã‚ˆã†ã«ã¾ã¨ã‚ã¦ãã‚ŒãŸäººãŒã„ã¾ã™ã€‚
4GB GPU VRAMã®ã‚µãƒãƒ¼ãƒˆã‚‚ã‚ã‚ŠStable Diffusionç­‰ã‚’ç°¡å˜ã«UIã‹ã‚‰ä½¿ã„ãŸã„æ–¹ã¯
ã“ã‚Œã‚’ä½¿ã‚ã›ã¦è²°ã†ã¨å¤§ä½“ã®ã‚²ãƒ¼ãƒŸãƒ³ã‚°PCã‚„GPUä»˜ãã®Windowsãƒãƒ¼ãƒˆPCã§ã‚‚å‹•ã‹ã›ã‚‹æ§˜ãªã®ã§è‰¯ã„ã‹ã¨æ€ã„ã¾ã™ã€‚

https://github.com/AbdBarho/stable-diffusion-webui-docker


â–¼ç’°å¢ƒ
Ubuntu 20.04

# å‰æº–å‚™
æœ€åˆã«ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦ãŠãã¾ã™
```js
$ git clone https://github.com/AbdBarho/stable-diffusion-webui-docker.git
Cloning into 'stable-diffusion-webui-docker'...
remote: Enumerating objects: 434, done.
remote: Counting objects: 100% (161/161), done.
remote: Compressing objects: 100% (65/65), done.
remote: Total 434 (delta 139), reused 96 (delta 96), pack-reused 273
Receiving objects: 100% (434/434), 83.40 KiB | 20.85 MiB/s, done.
Resolving deltas: 100% (220/220), done.

$ cd stable-diffusion-webui-docker
```
cacheãƒ•ã‚©ãƒ«ãƒ€ã®ä¸­ã‚’è¦‹ã‚‹ã¨ã“ã“ã«æ¨è«–ã§ä½¿ã‚ã‚Œã‚‹model.ckptãŒã‚ã‚‹æ§˜ã§ã™ã€‚

```js
ls ~/git/stable-diffusion-webui-docker/cache/models/model.ckpt
/home/keigo/git/stable-diffusion-webui-docker/cache/models/model.ckpt
```
model.ckptã‚’waifu-diffusionã®ãƒ¢ãƒ‡ãƒ«ã«å·®ã—æ›¿ãˆã¦ãŠãã¾ã™ã€‚
ã“ã‚Œã§Waifu Diffusionã®ãƒ¢ãƒ‡ãƒ«ãŒDockerã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã¨ãã«èª­ã¿è¾¼ã¾ã‚Œã¾ã™ã€‚
â€»hugging faceå´ã«è² è·ãŒã‹ã‹ã‚Šãã†ãªã®ã§æ—¢ã«Waifu Diffusionã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿ã®æ–¹ã¯
ã€€ãƒ•ã‚¡ã‚¤ãƒ«ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼ãªã©ã§ã“ã“ã«model.ckptã®åå‰ã§ãƒ¢ãƒ‡ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã—ã¦ãã ã•ã„ã€‚
```js
cd ~/git/stable-diffusion-webui-docker/cache/models/
mv model.ckpt model.ckpt.old
wget https://thisanimedoesnotexist.ai/downloads/wd-v1-2-full-ema.ckpt
mv wd-v1-2-full-ema.ckpt model.ckpt
```



# 1 Setupãƒšãƒ¼ã‚¸ã«ã—ãŸãŒã£ã¦é€²ã‚ã¾ã™
https://github.com/AbdBarho/stable-diffusion-webui-docker/wiki/Setup


# 2 docker compose ã§ç’°å¢ƒã‚’ãƒ“ãƒ«ãƒ‰ã—ã¾ã™
â€» --profile [ui] ã¯autoã§æŒ‡å®šã—ã¾ã—ãŸã€‚

```js
docker compose --profile download up --build
# wait until its done, then:
docker compose --profile [ui] up --build
# where [ui] is one of: auto | auto-cpu | hlky | lstein
```

# 3ã€€æœ€çµ‚çš„ã«modelã‚’ãƒ­ãƒ¼ãƒ‰ã—ã¦local URLã§æä¾›ã•ã‚Œã‚‹ã®ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹äº‹ã§Web UIãŒé–‹ãã¾ã™

```js
webui-docker-automatic1111-1  | Loading weights [7460a6fa] from /cache/models/model.ckpt
webui-docker-automatic1111-1  | Global Step: 470000
webui-docker-automatic1111-1  | Model loaded.
webui-docker-automatic1111-1  | Running on local URL:  http://0.0.0.0:7860
webui-docker-automatic1111-1  | 
webui-docker-automatic1111-1  | To create a public link, set `share=True` in `launch()`.
```

â–¼ãƒ–ãƒ©ã‚¦ã‚¶ã‚¢ã‚¯ã‚»ã‚¹å¾Œã®è¡¨ç¤º
![](https://storage.googleapis.com/zenn-user-upload/592138c5d290-20220918.png)

docker container ã‚‚å‹•ã„ã¦ã¾ã™ã­
```js
$ docker ps -a
CONTAINER ID   IMAGE                                                  COMMAND                  CREATED          STATUS                      PORTS                    NAMES
398a3624c24d   webui-docker_download                                  "/docker/download.sh"    25 minutes ago   Exited (0) 21 minutes ago                            webui-docker-download-1
```

# ãƒ†ã‚¹ãƒˆçµæœ

txt2txtã‚¿ãƒ–ã‹ã‚‰promptã«å…¥åŠ›ã—ã¦generateã‚’æŠ¼ã™ã¨stable diffusionã®ãƒ¢ãƒ‡ãƒ«ã‚ˆã‚Š
æ—¥æœ¬ã®ã‚¢ãƒ‹ãƒ¡èª¿ã‚’å¼·ãåæ˜ ã—ãŸçµµãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

â–¼stable-diffusionã®ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ãŸå ´åˆã®å‡ºåŠ›ç”»åƒ
![](https://storage.googleapis.com/zenn-user-upload/3a98a2a39f11-20220918.png)


â–¼waifu-diffusionã®ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ãŸå ´åˆã®å‡ºåŠ›ç”»åƒã¯ã“ã¡ã‚‰
![](https://storage.googleapis.com/zenn-user-upload/f9cb1483ca9e-20220918.png)


# Thanks
thanks to everyone behind these awesome projects, 
First I would like to contribute the project by introducing best environment run with the user PC environment.
And I will contribute the democratized AI through this activity.

AbdBarho/stable-diffusion-webui-docker#thanks
hlky/stable-diffusion-webui
AUTOMATIC1111/stable-diffusion-webui
lstein/stable-diffusion
CompVis/stable-diffusion
hlky/sd-enable-textual-inversion
devilismyfriend/latent-diffusion
Hafiidz/latent-diffusion